
async function loadProjects(){ const res = await fetch('assets/js/projects.json'); window.projects = await res.json(); renderProjects(window.projects); }
function renderProjects(list){ const root = document.getElementById('projects-root'); if(!root) return; root.innerHTML=''; list.forEach(p=>{ const el=document.createElement('div'); el.className='project'; el.innerHTML=`<h3>${p.title}</h3><div class="muted">${p.category} â€” ${p.date}</div><p>${p.summary}</p><button class="btn" data-id="${p.id}">En savoir plus</button>`; root.appendChild(el); }); document.querySelectorAll('[data-id]').forEach(b=>b.addEventListener('click',(e)=>openModal(e.currentTarget.getAttribute('data-id')))); }
function openModal(id){ const p = (window.projects||[]).find(x=>x.id===id); if(!p) return; const m=document.getElementById('modal'); document.getElementById('modal-title').innerText=p.title; document.getElementById('modal-body').innerText=p.details; m.setAttribute('aria-hidden','false'); }
function closeModal(){ document.getElementById('modal').setAttribute('aria-hidden','true'); }
document.addEventListener('click',e=>{ if(e.target && e.target.id==='modal-close') closeModal(); if(e.target && e.target.id==='modal') closeModal(); });
function animateCounters(){ document.querySelectorAll('.num').forEach(el=>{ const target=+el.getAttribute('data-target'); let cur=0; const step=Math.ceil(target/30); const t=setInterval(()=>{ cur+=step; if(cur>=target){ el.innerText=target; clearInterval(t);}else el.innerText=cur; },40); }); }
function setupCarousel(){ let idx=0; const items=document.querySelectorAll('.carousel-item'); const show=function(i){ items.forEach((it,ii)=>it.style.display=(ii===i?'block':'none')); }; show(0); setInterval(()=>{ idx=(idx+1)%items.length; show(idx); },4000); }
function setupLang(){ const btns=document.querySelectorAll('#lang-btn'); btns.forEach(btn=>btn.addEventListener('click',()=>{ const cur=document.documentElement.getAttribute('lang')||'fr'; if(cur==='fr'){ translateToEN(); document.documentElement.setAttribute('lang','en'); btn.innerText='FR'; } else { translateToFR(); document.documentElement.setAttribute('lang','fr'); btn.innerText='EN'; } })); }
function translateToEN(){ document.querySelectorAll('[data-fr]').forEach(el=>{ el.dataset.orig=el.innerHTML; if(el.getAttribute('data-en')) el.innerHTML=el.getAttribute('data-en'); }); }
function translateToFR(){ document.querySelectorAll('[data-fr]').forEach(el=>{ el.innerHTML=el.dataset.orig||el.getAttribute('data-fr'); }); }
window.addEventListener('DOMContentLoaded',()=>{ loadProjects(); animateCounters(); setupCarousel(); setupLang(); });
